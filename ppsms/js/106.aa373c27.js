(self["webpackChunkvue_event"]=self["webpackChunkvue_event"]||[]).push([[106],{6045:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var i=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix header-box",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("文章列表")])]),t("div",{staticClass:"search-box"},[t("el-form",{attrs:{inline:!0,model:e.q}},[t("el-form-item",{attrs:{label:"文章分类",size:"small"}},[t("el-select",{attrs:{placeholder:"文章分类"},model:{value:e.q.cate_id,callback:function(t){e.$set(e.q,"cate_id",t)},expression:"q.cate_id"}},e._l(e.cateList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"发布状态",size:"small"}},[t("el-select",{attrs:{placeholder:"发布状态"},model:{value:e.q.state,callback:function(t){e.$set(e.q,"state",t)},expression:"q.state"}},[t("el-option",{attrs:{label:"已发布",value:"已发布"}}),t("el-option",{attrs:{label:"草稿",value:"草稿"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.initListFn}},[e._v("查询")]),t("el-button",{attrs:{type:"info",size:"small"},on:{click:e.resetListFn}},[e._v("重置")])],1)],1),t("el-dialog",{attrs:{title:"test",visible:e.flag},on:{"update:visible":function(t){e.flag=t}}}),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.showDialogFn}},[e._v("发布文章")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.artList,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"title",label:"文章标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.showDetailFn(a.row.id)}}},[e._v(" "+e._s(a.row.title))])]}}])}),t("el-table-column",{attrs:{prop:"cate_name",label:"分类",width:"180"}}),t("el-table-column",{attrs:{prop:"pub_date",label:"发表时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(" "+e._s(e.$formateDate(a.row.pub_date))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"state",label:"状态"}}),t("el-table-column",{attrs:{label:"操作"}})],1),t("el-pagination",{attrs:{"current-page":e.q.pagenum,"page-sizes":[2,3,5,10],"page-size":e.q.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.q,"pagenum",t)},"update:current-page":function(t){return e.$set(e.q,"pagenum",t)},"update:pageSize":function(t){return e.$set(e.q,"pagesize",t)},"update:page-size":function(t){return e.$set(e.q,"pagesize",t)}}}),t("el-dialog",{attrs:{fullscreen:"",title:"发表文章",visible:e.pubDialogvisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.pubDialogvisible=t},closed:e.closeFn}},[t("el-form",{ref:"pubFormRef",attrs:{model:e.pubForm,rules:e.pubFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.pubForm.title,callback:function(t){e.$set(e.pubForm,"title",t)},expression:"pubForm.title"}})],1),t("el-form-item",{attrs:{label:"文章分类",prop:"cate_id"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择活动区域"},model:{value:e.pubForm.cate_id,callback:function(t){e.$set(e.pubForm,"cate_id",t)},expression:"pubForm.cate_id"}},e._l(e.cateList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.cate_name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"文章内容",prop:"content"}},[t("quill-editor",{on:{blur:e.quillRequiredFn},model:{value:e.pubForm.content,callback:function(t){e.$set(e.pubForm,"content",t)},expression:"pubForm.content"}})],1),t("el-form-item",{attrs:{label:"文章封面",prop:"cover_img"}},[t("input",{directives:[{name:"show",rawName:"v-show",value:0,expression:"0"}],ref:"iptFileRef",attrs:{type:"file",accept:"image/*"},on:{change:e.changeCoverFn}}),t("img",{staticClass:"the_img",attrs:{src:e.coverImgSrc,alt:""},on:{click:e.chooseImgFn}}),t("br"),t("el-button",{attrs:{type:"text"}},[e._v("+ 选择封面")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.pubArticFn("已发布")}}},[e._v("发布")]),t("el-button",{attrs:{type:"info"},on:{click:function(t){return e.pubArticFn("存草稿")}}},[e._v("存为草稿")])],1)],1)],1)],1)},s=[],r=(a(2062),a(7377)),l=a.p+"img/cover.54bfb07c.jpg",n={name:"ArtList",data(){return{flag:!1,pubDialogvisible:!1,q:{pagenum:1,pagesize:5,cate_id:"",state:""},pubForm:{cate_id:"",title:"",content:"",cover_img:null,state:""},pubFormRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:1,max:30,message:"文章标题的长度为1-30个字符",trigger:"blur"}],cate_id:[{required:!0,message:"请填入文章标题",trigger:"change"}],content:[{required:!0,message:"请选择分类",trigger:"blur"}],cateList:[{required:!0,message:"请填入内容",trigger:"change"}],cover_img:[{required:!0,message:"请选择封面",trigger:"blur"}]},cateList:[],artList:[],total:0}},methods:{showDialogFn(){this.pubDialogvisible=!0},async handleClose(e){const t=await this.$confirm("此操作将导致文章信息丢失, 是否继续?","提示",{type:"warning"}).catch((e=>e));"cancel"!==t&&e()},async getCateListFn(){const{data:e}=await(0,r.I2)();this.cateList=e.data},async getArtListFn(){const{data:e}=await(0,r.r4)(this.q);if(0!==e.code)return this.$message.error(e.message);this.artList=e.data,this.total=e.total},changeCoverFn(e){const t=e.target.files;0===t.length?this.pubForm.cover_img=null:this.pubForm.cover_img=t[0],this.$refs.pubFormRef.validateField("cover_img")},chooseImgFn(){this.$refs.iptFileRef.click()},pubArticFn(e){this.$refs.pubFormRef.validate((t=>{if(this.pubForm.state=e,!t)return!1;{const e=new FormData;Object.keys(this.pubForm).forEach((t=>{e.append(t,this.pubForm[t])})),(0,r.Eg)(e).then((({data:e})=>{if(0===e.code)this.$message.success(e.message);else{if(2!==e.code)return this.$message.error(e.message);this.$message.success(e.message)}this.pubDialogvisible=!1,this.getArtListFn()}))}}))},quillRequiredFn(){this.$refs.pubFormRef.validateField("content")},closeFn(){this.$refs.pubFormRef.resetFields()},handleSizeChange(e){this.q.pagesize=e,this.q.pagenum=1,this.getArtListFn()},handleCurrentChange(e){this.q.pagenum=e,this.getArtListFn()},initListFn(){this.q.pagenum=1,this.q.pagesize=5,this.getArtListFn()},resetListFn(){this.q={pagenum:1,pagesize:5,cate_id:"",state:""},this.getArtListFn()},async showDetailFn(e){const t=await(0,r.$D)(e);console.log(t)}},created(){this.getCateListFn(),this.getArtListFn()},computed:{coverImgSrc(){return this.pubForm.cover_img?URL.createObjectURL(this.pubForm.cover_img):l}}},o=n,c=a(1001),u=(0,c.Z)(o,i,s,!1,null,"2edee3a7",null),p=u.exports},7045:function(e,t,a){var i=a(6339),s=a(3070);e.exports=function(e,t,a){return a.get&&i(a.get,t,{getter:!0}),a.set&&i(a.set,t,{setter:!0}),s.f(e,t,a)}},2062:function(e,t,a){"use strict";var i=a(9781),s=a(1702),r=a(7045),l=URLSearchParams.prototype,n=s(l.forEach);i&&!("size"in l)&&r(l,"size",{get:function(){var e=0;return n(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=106.aa373c27.js.map